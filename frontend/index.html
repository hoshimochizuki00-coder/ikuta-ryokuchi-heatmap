<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>生田緑地 環境ヒートマップ</title>
  <link rel="icon" href="./assets/favicon.ico" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header id="app-header">
    <span class="title">生田緑地 環境ヒートマップ（2016–現在）</span>
    <div class="header-links">
      <a href="https://github.com/hoshimochizuki00-coder/ikuta-ryokuchi-heatmap/releases" class="header-link" target="_blank" rel="noopener">データDL</a>
      <a href="https://github.com/hoshimochizuki00-coder/ikuta-ryokuchi-heatmap" class="header-link" target="_blank" rel="noopener">GitHub</a>
      <a href="#disclaimer" class="disclaimer-link">免責事項</a>
    </div>
  </header>

  <div id="control-bar">
    <div id="indicator-selector">
      <label>
        <input type="radio" name="indicator" value="ndvi" checked />
        <span>NDVI</span>
        <span class="indicator-info"
              aria-label="植生活性度。-1〜+1の範囲で、高いほど植物が旺盛。生田緑地の緑の分布と季節変化を把握できる。">ⓘ</span>
      </label>
      <label>
        <input type="radio" name="indicator" value="evi" />
        <span>EVI</span>
        <span class="indicator-info"
              aria-label="強化植生指数。NDVIの密林部での飽和を補正した指標。森林中心部の変化検出に有効。">ⓘ</span>
      </label>
      <label>
        <input type="radio" name="indicator" value="ndwi" />
        <span>NDWI</span>
        <span class="indicator-info"
              aria-label="水分量指数。植生の乾燥ストレスや水分分布を示す。-1〜+1で、高いほど水分が豊富。">ⓘ</span>
      </label>
      <label>
        <input type="radio" name="indicator" value="lst" />
        <span>LST</span>
        <span class="indicator-info"
              aria-label="地表面温度（摂氏）。Landsat熱赤外バンド由来。緑地の冷却効果とヒートアイランドの比較に使用。雲の影響で欠損月が出やすい。">ⓘ</span>
      </label>
    </div>
    <div id="month-slider-container">
      <button id="btn-prev">&#9664;</button>
      <div id="slider-wrapper">
        <input type="range" id="month-slider" min="0" max="119" value="119" />
        <canvas id="missing-indicator" height="6"></canvas>
        <div id="missing-legend">
          <span class="missing-dot"></span><span>欠損月</span>
        </div>
      </div>
      <button id="btn-next">&#9654;</button>
      <span id="month-label">----/--</span>
    </div>
    <button id="btn-basemap" class="active" title="ベースマップの表示切替">モノクロ</button>
  </div>

  <div id="map"></div>

  <div id="chart-area">
    <div id="chart-mode-toggle">
      <label class="chart-mode-label">
        <input type="radio" name="chart-mode" value="summary" checked />
        エリア平均
      </label>
      <label class="chart-mode-label">
        <input type="radio" name="chart-mode" value="pixel" />
        地点別
      </label>
    </div>
    <div id="chart-placeholder">地図をクリックして地点を選択してください</div>
    <canvas id="timeseries-chart" style="display:none;"></canvas>
    <div id="chart-note">※ エリア全体の平均値を表示しています（地点別表示は今後対応予定）</div>
  </div>

  <div id="disclaimer">
    本データは個人が作成したものであり、正確性・完全性を保証しません。
    衛星データの性質上、雲の影響による欠損や精度のばらつきが生じる場合があります。
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
  <!-- geotiff.js・Chart.js はデプロイ時に CI がダウンロード → assets/js/ 以下に配置 -->
  <script src="./assets/js/geotiff.js"></script>
  <script src="./assets/js/chart.umd.min.js"></script>
  <script src="renderer.js"></script>
  <script src="chart.js"></script>
  <script src="app.js"></script>
</body>
</html>
